##################################
#  ____________________________
# (   _________________________)
#  ) (__  _  _  _    _
# (   __)( \/ )( \/\/ )/\/\
#  ) (    \  /  \    //    \
# (___)    \/    \/\/(_/\/\_) 3
#
# chrispwd's fvwm3
##################################


# Environment Variables ########################################################

InfoStoreAdd terminal st
InfoStoreAdd TabDir Next
DesktopConfiguration global

# ColorSets ####################################################################

# Color Scheme Camouflage
Colorset 0 fg white, bg #6e7d76, hi, sh, Plain, NoShape
Colorset 1 fg white, bg #6e7d76, hi, sh, Plain, NoShape
Colorset 2 fg black, bg #acbeb4, hi, sh, Plain, NoShape
Colorset 3 fg white, bg #6e7d76, hi, sh, Plain, NoShape
Colorset 4 fg white, bg #acbeb4, hi, sh, Plain, NoShape
Colorset 5 fg white, bg #6e7d76, hi, sh, Plain, NoShape
Colorset 6 fg white, bg #907b7b, hi, sh, Plain, NoShape
Colorset 7 fg white, bg #82829b, hi, sh, Plain, NoShape
Colorset 8 fg white, bg #6e7d76, hi, sh, Plain, NoShape

# Style lines ##################################################################

# No pages. I don't have an use case for pages.
DesktopSize 1x1

# 1-base indexed dekstops
DesktopName 0 1
DesktopName 1 2
DesktopName 2 3
DesktopName 3 4
DesktopName 4 5
DesktopName 5 6

DefaultFont "xft:serif:size=11"

# No pages, so no need for view port scrolling with mouse.
EdgeScroll 0 0
EdgeResistance -1
EdgeThickness 1

# Ignore Numlock and other modifiers for bindings
# See http://fvwm.org/documentation/faq/#why-do-numlock-capslock-and-scrolllock-interfere-with-clicktofocus-andor-my-mouse-bindings
IgnoreModifiers L25

# ICCCM allows windows to tell the WM to not give them keyboard focus.
# Many windows use this incorrectly and expect keyboard focus anyways.
# This styles tells fvwm to ignore this property, which makes some
# applications (such as java and electron apps) behave better.
Style * Lenience

# Must explicitly click a window to focus
Style * ClickToFocus, MouseFocusClickRaises

# use EWMH hints and respect EWMH hints which change the window layer
Style * EWMHUseStackingOrderHints

# Global decor color/styling
Style * Colorset 1, HilightColorset 2, \
        BorderColorset 3, HilightBorderColorset 4, \
        BorderWidth 5, HandleWidth 5, \
        MWMBorder, DepressableBorder, \
        MWMButtons, UseDecor CDEDecor

TitleStyle LeftJustified

# Specific styles
Style nsxiv         NoTitle
Style "xclock"      !Title, WindowListSkip, \
                    StaysOnBottom, Sticky, NoHandles
Style "xosview"     !Title, WindowListSkip, \
                    StaysOnBottom, Sticky, NoHandles
Style FB-SystemTray !Title, !Borders, WindowListSkip, \
                    StaysOnBottom, Sticky, NoHandles, \
                    NeverFocus
Style FB-FvwmDock   !Title, !Borders, !Handles, WindowListSkip, \
                    StaysOnBottom, Sticky, NoHandles, \
                    NeverFocus
Style FvwmPager     !Title, WindowListSkip, NoHandles, \
                    StaysOnBottom, Sticky, NeverFocus

# Root menu
DestroyMenu MenuFvwmRoot
AddToMenu   MenuFvwmRoot "Fvwm" Title
+ "$[gt.&Restart]%icons/restart.png%" Restart
+ "$[gt.&Quit]%icons/quit.png%"       Module FvwmScript FvwmScript-ConfirmQuit

EwmhBaseStruts screen $[monitor.primary] 5 5 5 5

# CDE Decor
AddToDecor CDEDecor
+ TitleStyle    AllInactive -- Raised
+ TitleStyle    AllActive -- Raised
+ ButtonStyle   All Simple -- UseTitleStyle
+ BorderStyle   Simple
+ TitleStyle    LeftJustified -- Raised
+ ButtonStyle   All -- Raised

+ AddButtonStyle 1 Vector 3 23x58@0 77x58@0 77x42@0
+ AddButtonStyle 1 Vector 3 23x58@1 23x42@1 77x42@1

+ AddButtonStyle 2 Vector 3 21x79@0 79x79@0 79x21@0
+ AddButtonStyle 2 Vector 3 21x79@1 21x21@1 79x21@1

+ AddButtonStyle 4 Vector 3 42x58@0 58x58@0 58x42@0
+ AddButtonStyle 4 Vector 3 42x58@1 42x42@1 58x42@1

+ TitleStyle Height MinHeight 20

# Bindings #####################################################################

# Alt-tab
Key Tab A M  SwitchWindow

# Alt-F1 to open root menu
Silent Key F1      A M Menu MenuFvwmRoot

Mouse 3 R    A Menu MenuFvwmRoot
Mouse 1 R    A WindowList

# window button controls, i.e. [<1> <title>  <4><2>]
Mouse 1 4 A Iconify
Mouse 1 2 A Maximize
Mouse 1 1 A Nop

## Window moves

# move window 5% <dir>
Key h  A  4  Move w-5 keep Warp
Key j  A  4  Move keep w+5 Warp
Key k  A  4  Move keep w-5 Warp
Key l  A  4  Move w+5 keep Warp

# move window 10% <dir>
Key h  A  4S  Move w-10 keep Warp
Key j  A  4S  Move keep w+10 Warp
Key k  A  4S  Move keep w-10 Warp
Key l  A  4S  Move w+10 keep Warp

# snap window
Key h  A  4C  Move shuffle Left
Key j  A  4C  Move shuffle Down
Key k  A  4C  Move shuffle Up
Key l  A  4C  Move shuffle Right

# maximize window
Key m  A  4M  Maximize 100 100

# temp vert/horiz max
Key v  A  4M  Maximize 0 100
Key g  A  4M  Maximize 100 0

# grow/shrink window
Key j  A  4SM  ResizeMove w+5 w+5 w-5w w-5w Warp
Key k  A  4SM  ResizeMove w-5 w-5 w+5w w+5w Warp

## Desktop manipulation

Silent Key 1       A 4 GotoDesk 0 0
Silent Key 2       A 4 GotoDesk 0 1
Silent Key 3       A 4 GotoDesk 0 2
Silent Key 4       A 4 GotoDesk 0 3
Silent Key 5       A 4 GotoDesk 0 4
Silent Key 6       A 4 GotoDesk 0 5
#Silent Key 7       A 4 GotoDesk 0 6
#Silent Key 8       A 4 GotoDesk 1 2
#Silent Key 9       A 4 GotoDesk 2 2
Silent Key 1       A 4S MovetoDesk 0 0
Silent Key 2       A 4S MovetoDesk 0 1
Silent Key 3       A 4S MovetoDesk 0 2
Silent Key 4       A 4S MovetoDesk 0 3
Silent Key 5       A 4S MovetoDesk 0 4
Silent Key 6       A 4S MovetoDesk 0 5
# Silent Key 7       A 4S MovetoDesk 0 6
# Silent Key 8       A 4S MovetoDesk 1 2
# Silent Key 9       A 4S MovetoDesk 2 2

## WM actions

# close window
Key w  A  4  Close

# restart fvwm3
Key r  A  4S  Restart
Key q  A  4S  Quit

# Functions ####################################################################

DestroyFunc FocusRaiseAndStuff
AddToFunc   FocusRaiseAndStuff
+ I Iconify off
+ I Focus
+ I Raise

DestroyFunc SwitchDirection
AddToFunc   SwitchDirection
+ I Test (EnvMatch infostore.TabDir Next) InfoStoreAdd TabDir Prev
+ I TestRc (NoMatch) InfoStoreAdd TabDir Next

# Makes alt-tab keep window cycling direction if pressed within 700ms
DestroyFunc SwitchWindow
AddToFunc   SwitchWindow
+ I $[infostore.TabDir] (CurrentPage, !Iconic, !Sticky) FocusRaiseAndStuff
+ I Deschedule 134000
+ I Schedule 700 134000 SwitchDirection


# === StartFunction ===
DestroyFunc StartFunction
AddToFunc   StartFunction
+ I Module FvwmPager 0 5
+ I Module FvwmButtons FB-FvwmDock
+ I Test (Init) Exec exec $[infostore.terminal] -T 'ChuddieTerm'
#+ I Test (Restart) Exec exec set-monitors

# Modules ####################################################################

DestroyModuleConfig FvwmPager:*
*FvwmPager: Geometry 64x384+0+0
*FvwmPager: Rows 6
*FvwmPager: Columns 1
*FvwmPager: Colorset * 6
*FvwmPager: HilightColorset * 7
*FvwmPager: BalloonColorset * 6
*FvwmPager: Font 6x13
*FvwmPager: Balloons All
*FvwmPager: BalloonFont 6x13
*FvwmPager: BallonYOffset +2
*FvwmPager: WindowColorsets 3 5
*FvwmPager: Window3DBorders
*FvwmPager: WindowBorderWidth 1
*FvwmPager: WindowFont None
*FvwmPager: Mouse 1 ChangePage
*FvwmPager: Mouse 3 MoveWindow FlipFocus NoWarp
*FvwmPager: SloppyFocus

DestroyModuleConfig FB-SystemTray: *
*FB-SystemTray: Geometry 64x64-0-0
*FB-SystemTray: Colorset 1
*FB-SystemTray: ReliefThickness 2
*FB-SystemTray: Columns 64
*FB-SystemTray: Rows 64
*FB-SystemTray: (64x128, Swallow(NoClose,UseOld) "stalonetray" 'Exec exec stalonetray --config \
             "$[FVWM_DATADIR]/.stalonetrayrc"', Frame 0)

DestroyModuleConfig FB-FvwmDock: *
*FB-FvwmDock: Geometry 96x64+0-0
*FB-FvwmDock: Rows 1
*FB-FvwmDock: Columns 1
# *FB-FvwmDock: Frame 2
# *FB-FvwmDock: Padding 2 2
# *FB-FvwmDock: ReliefThickness 2
*FB-FvwmDock: Colorset * 3
*FB-FvwmDock: HighlightColorset * 4
# *FB-FvwmDock: (64x64, Swallow(NoClose,UseOld) "xosview" 'Exec exec xosview', Frame 0)
*FB-FvwmDock: (96x64, Swallow(NoClose,UseOld) "stalonetray" 'Exec exec stalonetray --config \
             "$[FVWM_USERDIR]/.stalonetrayrc"', Frame 0)
